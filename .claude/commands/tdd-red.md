# TDD Red フェーズコマンド

あなたはTDD（テスト駆動開発）の専門家です。Red フェーズとして、意図的に失敗するテストを作成してください。

## Red フェーズの目的

1. **意図的な失敗テスト作成**
   - まだ実装されていない機能のテストを書く
   - テストが赤（失敗）になることを確認
   - 実装すべき機能の仕様を明確化

2. **Given-When-Then構造**
   - **Given**: テストの前提条件・データ準備
   - **When**: 実行するアクション
   - **Then**: 期待される結果

## 実行手順

1. **テスト対象の理解**
   - 実装する機能の仕様確認
   - 入力・出力・動作の定義
   - エッジケースの特定

2. **テストケース設計**
   - 正常系テスト: 期待される正常な動作
   - 異常系テスト: エラーハンドリング
   - 境界値テスト: 最小値・最大値での動作

3. **テスト実装**
   - Given-When-Then構造で実装
   - 日本語コメントで目的を明記
   - 信頼性レベル 🔴 を記載

4. **テスト実行確認**
   - テストが失敗することを確認
   - 期待されるエラーメッセージの確認

## テンプレート構造

`~/workspace/cc-knowledge/templates/tdd/red-phase-template.md` を参考に、以下の形式で実装：

```typescript
describe('[機能名]', () => {
  test('[期待動作の説明]', () => {
    // Given: [前提条件・テストデータの準備]
    const testData = [テストデータ];
    
    // When: [実行するアクション]
    const result = [実行する関数](testData);
    
    // Then: [期待される結果]
    expect(result).toBe([期待値]);
    // 信頼性レベル: 🔴（まだ実装されていない）
  });
});
```

## 必須実装パターン

### 1. 正常系テスト
```typescript
describe('[機能名] - 正常系', () => {
  test('有効な入力で正常に処理される', () => {
    // Given: 有効な入力データ
    // When: 機能を実行
    // Then: 期待される結果が返される
    // 信頼性レベル: 🔴
  });
});
```

### 2. 異常系テスト
```typescript
describe('[機能名] - 異常系', () => {
  test('無効な入力でエラーが発生する', () => {
    // Given: 無効な入力データ
    // When & Then: エラーが発生することを確認
    expect(() => {
      [実行する関数](invalidInput);
    }).toThrow('[期待されるエラーメッセージ]');
    // 信頼性レベル: 🔴
  });
});
```

### 3. 境界値テスト
```typescript
describe('[機能名] - 境界値', () => {
  test('境界値で適切に処理される', () => {
    // Given: 境界値データ
    // When: 機能を実行
    // Then: 境界値での期待動作
    // 信頼性レベル: 🔴
  });
});
```

## 品質チェックリスト

### 必須項目
- [ ] テストの目的が日本語コメントで明記されている
- [ ] Given-When-Then構造で記述されている
- [ ] 信頼性レベル 🔴 が記載されている
- [ ] 期待値が具体的に定義されている
- [ ] テストが失敗することを確認済み

### テストカバレッジ
- [ ] 正常系がカバーされている
- [ ] 異常系がカバーされている
- [ ] 境界値がカバーされている
- [ ] エッジケースが考慮されている

## 実行コマンド

テスト作成後、以下を実行：
```bash
# テスト実行（失敗確認）
npm test [テストファイル]

# 失敗ログの確認
npm test -- --verbose
```

## 出力ファイル

テストファイルの作成・更新：
- 新規: `[対象ディレクトリ]/[機能名].test.ts`
- 既存: 既存テストファイルにテストケース追加

## 次のフェーズ

Red フェーズ完了後：
1. `/tdd-green [失敗テストファイル]` - Green フェーズ（最小実装）
2. テスト失敗の確認とエラーメッセージの妥当性チェック

## 注意事項

- **実装は一切行わない**（テストのみ）
- **テストが失敗することを必ず確認**
- **1つの機能に集中する**（複数機能を同時にテストしない）
- **テストケースは独立性を保つ**

テスト対象の機能を指定してください。意図的に失敗するテストを作成します。